<Window x:Class="FamilyTreeApp.UI.Windows.GroupsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="Manage Groups" 
        Height="500" Width="400"
        Background="{DynamicResource PrimaryBackgroundBrush}"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Closing="Window_Closing">
    
    <Window.Resources>
        <!-- ColorPicker Dark Style -->
        <Style TargetType="xctk:ColorPicker">
            <Setter Property="Background" Value="{DynamicResource TertiaryBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="DropDownBackground" Value="{DynamicResource TertiaryBackgroundBrush}"/>
            <Setter Property="HeaderBackground" Value="{DynamicResource SecondaryBackgroundBrush}"/>
            <Setter Property="HeaderForeground" Value="{DynamicResource PrimaryTextBrush}"/>
            <Setter Property="TabBackground" Value="{DynamicResource TertiaryBackgroundBrush}"/>
            <Setter Property="TabForeground" Value="{DynamicResource PrimaryTextBrush}"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title -->
        <TextBlock Grid.Row="0" Text="Groups" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
        
        <!-- Groups List -->
        <ListBox x:Name="GroupsListBox" 
                 Grid.Row="1" 
                 SelectionChanged="GroupsListBox_SelectionChanged">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Rectangle Width="16" Height="16" Margin="0,0,10,0">
                            <Rectangle.Fill>
                                <SolidColorBrush Color="{Binding Color}"/>
                            </Rectangle.Fill>
                        </Rectangle>
                        <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        
        <!-- Group Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,10">
            <Button Content="+ Add Group" Click="AddGroup_Click" Margin="0,0,8,0"/>
            <Button Content="- Remove" Click="RemoveGroup_Click"/>
        </StackPanel>
        
        <!-- Selected Group Properties -->
        <GroupBox Grid.Row="3" Header="Selected Group" Padding="10">
            <Grid x:Name="GroupPropertiesPanel" IsEnabled="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Name -->
                <Label Grid.Row="0" Grid.Column="0" Content="Name:"/>
                <TextBox x:Name="GroupNameTextBox" Grid.Row="0" Grid.Column="1" 
                         TextChanged="GroupNameTextBox_TextChanged"/>
                
                <!-- Color -->
                <Label Grid.Row="1" Grid.Column="0" Content="Color:" Margin="0,10,0,0"/>
                <xctk:ColorPicker x:Name="GroupColorPicker" Grid.Row="1" Grid.Column="1" 
                                  Margin="0,10,0,0"
                                  SelectedColorChanged="GroupColorPicker_SelectedColorChanged"/>
                
                <!-- Visibility -->
                <CheckBox x:Name="GroupVisibleCheckBox" Grid.Row="2" Grid.Column="1" 
                          Content="Visible" Margin="0,10,0,0"
                          Checked="GroupVisibleCheckBox_Changed" 
                          Unchecked="GroupVisibleCheckBox_Changed"/>
            </Grid>
        </GroupBox>
        
        <!-- Action Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Apply" Click="Apply_Click" Width="75" Margin="0,0,8,0"/>
            <Button Content="Cancel" Click="Cancel_Click" Width="75" Margin="0,0,8,0"/>
            <Button Content="Close" Click="Close_Click" Width="75"/>
        </StackPanel>
    </Grid>
</Window>